# アーキテクチャとは

## 設計

### 設計の根幹にある考え方

**複雑な問題は、より単純な問題の群として切り分けるべき。そのためにシステムが部品(モジュール)の集合として構成される必要がある。それぞれの部品は狭い関心を持ち、一つの問題にだけ対処する(関心の分離)。部品が正しく組み合わさって動けば、総体として大きな問題を解決できる**

* 複雑な問題は、より単純な問題の群として切り分ける
  * **再現性のある問題に対する共通の解決策**である**設計パターン**が強い味方となる
  * 同じ問題に対する解決策には名前が付けられた(GoFのデザインパターンなど)
    * 「Mediator」「Observer」「Singleton」など

### 設計パターンを知るメリット

1. 問題を定型化して捉えられる

* 既知のパターンを通じて問題を捉え直せば、得体の知れなかった魔物が、慣れ親しんだ理解可能な構造として見ることができる

2. 解決策を客観的に比較できる

* それぞれのパターンの強み・弱みも、先人によってすでに検討済みのため、似ている2つのパターンの差分を確認すれば、どちらの方が適しているのか客観的に判断できる

3. メンバーの共通言語となる

* 設計が複雑になると、各部品の関連も一目では理解できなくなる。しかし、「XXパターン」と名前が与えられていれば誰もがその構造をイメージすることができ、開発の生産性も大きく上がる

### アーキテクチャも「パターン」

* 「アプリを動かす」という複雑な問題領域は、大まかに複数の層(レイヤー)へと切り分けられる
  * そこで活用されるのが**アーキテクチャ**(アプリの大まかなレイヤー分割の捉え方・考え方)

* アーキテクチャもアプリの問題を解決するためのパターンとなる
  * 各アプリの問題を単純な問題に切り分けた時に、共通の解決策が適用できる

### 設計プロセス

* **責務**
  * 解決すべき問題の領域

* **モジュール**
  * ひとまとまりの責務の置き場
  * 適切に責務分割が行われた状態では、モジュール内で責務がまとまっており(高凝集)、モジュール同士では責務が分かれている(疎結合)状態とされる

### 設計の原則

**責務の分割単位が適切かどうか検証するための物差し(コードから臭いを取り除く)**

* **硬さ**: 変更しにくいシステム。1つの変更によってシステムの他の部分に影響が及び、多くの変更を余儀なくさせるようなソフトウェア
* **もろさ**: 1つの変更によって、その変更とは概念的に関連のない箇所まで壊れてしまうようなソフトウェア
* **移植性のなさ**: 他のシステムでも再利用できる部分をモジュールとして切り離すことが困難なソフトウェア
* **不必要な繰り返し**: 同じような構造を繰り返し含み、抽象化してまとめられる部分がまとまっていないソフトウェア
* **不必要な複雑さ**: 本質的な意味を持たない構造を内包しているようなソフトウェア
* **不透明さ**: 読みにくく、分かりにくい。その意図がうまく伝わってこないソフトウェア

#### KISS

**Keep it sinmple, small: 簡潔に、より単純にしておけ**

#### YAGNI

**You are not Going to Need it: どうせ必要にならないよ**

## コラム

### ドメイン駆動設計(DDD)

**UIの都合や通信・永続化の処理を除いた、アプリが解決したい問題領域の知識そのもの(ドメイン)のみをレイヤーとして切り出し、そこでは非技術者の仕様策定者とも同じ言語を使い、モデリングを反復的に深化させることが価値の高いシステムを生み出すことに繋がるという設計思想**